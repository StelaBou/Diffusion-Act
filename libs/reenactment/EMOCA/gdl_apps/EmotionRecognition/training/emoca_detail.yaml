data:
  data_class: AffectNetEmoNetSplitModuleValTest
  input_dir: /ps/project/EmotionalFacialAnimation/data/affectnet
  output_dir: /is/cluster/work/rdanecek/data/affectnet/
  processed_subfolder: processed_2021_Apr_05_15-22-18
  num_workers: 16
  ignore_invalid: like_emonet
  n_expression: 8
  mode: manual
  image_size: 224
  scale: 1.25
  face_detector: fan
  face_detector_threshold: 0.9
  ring_type: none
  ring_size: none
  drop_last: true
  sampler: balanced_expr
  augmentation: []
model:
  emodeca_type: EmoDECA
  predict_expression: true
  predict_valence: true
  predict_arousal: true
  expression_balancing: false
  use_identity: true
  use_expression: true
  use_global_pose: false
  use_jaw_pose: true
  use_detail_code: false
  deca_checkpoint: null
  deca_cfg:
    data:
      data_class: AffectNetEmoNetSplitModule
      input_dir: /ps/project/EmotionalFacialAnimation/data/affectnet
      output_dir: /is/cluster/work/rdanecek/data/affectnet/
      processed_subfolder: processed_2021_Apr_05_15-22-18
      num_workers: 6
      ignore_invalid: like_emonet
      n_expression: 8
      mode: manual
      image_size: 224
      scale: 1.25
      face_detector: fan
      face_detector_threshold: 0.9
      ring_type: none
      ring_size: none
      drop_last: true
      sampler: balanced_expr
      augmentation:
      - Affine:
        - scale:
          - 0.9
          - 1.1
        - rotate:
          - -10.0
          - 10.0
        - translate_percent:
          - -0.05
          - 0.05
      - OneOf:
        - JpegCompression:
          - compression:
            - 50
            - 90
        - AdditiveGaussianNoise:
          - scale:
            - 0
            - 10
        - GaussianBlur:
          - sigma:
            - 0.0
            - 1.5
        - Sharpen:
          - lightness: 1.0
          - alpha:
            - 0.0
            - 0.5
        - Identity:
          - name: identity
    model:
      topology_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/geometry/head_template.obj
      fixed_displacement_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/geometry/fixed_uv_displacements/fixed_displacement_256.npy
      flame_model_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/geometry/generic_model.pkl
      flame_lmk_embedding_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/geometry/landmark_embedding.npy
      face_mask_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/mask/uv_face_mask.png
      face_eye_mask_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/mask/uv_face_eye_mask.png
      pretrained_modelpath: /mnt/500gb/Workspace/Repos/gdl/assets/DECA/data/deca_model.tar
      pretrained_vgg_face_path: /mnt/500gb/Workspace/Repos/gdl/assets/FaceRecognition/resnet50_ft_weight.pkl
      deca_class: ExpDECA
      expression_backbone: deca_clone
      max_epochs: 30
      val_check_interval: 0.2
      test_vis_frequency: 1
      val_vis_frequency: 200
      train_vis_frequency: 1000
      mode: coarse
      resume_training: false
      useSeg: rend
      background_from_input: false
      use_landmarks: false
      useWlmk: true
      lmk_weight: 1
      eyed: 0.5
      lipd: 0.5
      idw: 0
      exp_reg: 0.0001
      shape_reg: 0.0001
      tex_reg: 1.0e-05
      light_reg: 12
      use_photometric: true
      photow: 2.0
      shape_constrain_type: None
      expression_constrain_type: none
      expression_constrain_use_jaw_pose: true
      expression_constrain_use_global_pose: false
      use_geometric_losses_expression_exchange: false
      exp_deca_global_pose: false
      exp_deca_jaw_pose: false
      use_emonet_loss: true
      use_emonet_feat_1: false
      use_emonet_feat_2: true
      use_emonet_valence: false
      use_emonet_arousal: false
      use_emonet_expression: false
      use_emonet_combined: false
      emonet_weight: 1.0
      use_gt_emotion_loss: false
      gt_emotion_reg: 0.0
      n_shape: 100
      n_tex: 50
      n_exp: 50
      n_pose: 6
      n_cam: 3
      n_light: 27
      n_identity: 512
      n_dlatent: 512
      n_detail: 128
      image_size: 224
      uv_size: 256
      neural_renderer: false
      tex_type: BFM
      tex_path: /mnt/500gb/Workspace/Repos/gdl/assets/FLAME/texture/FLAME_albedo_from_BFM.npz
      emonet_model_path: ''
      emo_feat_loss: mse_loss
      photometric_normalization: mean
      use_mouth_corner_distance: true
      use_eye_distance: true
      use_lip_distance: true
    learning:
      learning_rate: 5.0e-05
      optimizer: Adam
      batch_size_train: 32
      batch_size_test: 1
      batch_size_val: 32
      train_K: 1
      val_K: 1
      test_K: 1
      train_K_policy: random
      val_K_policy: sequential
      test_K_policy: sequential
      num_gpus: 1
      gpu_memory_min_gb: 30
      early_stopping:
        patience: 15
      checkpoint_after_training: best
      logger_type: WandbLogger
    inout:
      output_dir: todo
      full_run_dir: todo
      checkpoint_dir: todo
      name: ExpDECA_Affec_clone_NoRing_EmoC_F2_DeSeggt_BlackC_Aug_early
      time: 2021_11_13_03-43-40
      random_id: '4753326650554236352'
      previous_run_dir: /is/cluster/work/rdanecek/emoca/finetune_deca/2021_11_09_19-00-11_2212703344027741137_ExpDECA_Affec_clone_NoRing_EmoB_F2_DeSegrend_BlackB_Aug_early/coarse
  deca_stage: coarse
  mlp_norm_layer: BatchNorm1d
  num_mlp_layers: 4
  mlp_dim: 2048
  finetune_deca: false
  predict_AUs: false
  a_loss:
    a_mse: 1.0
  v_loss:
    v_mse: 1.0
  va_loss:
    va_lpcc: 1.0
    va_lccc: 1.0
  exp_loss: nll_loss
  va_loss_scheme: shake
  a_activation: none
  v_activation: none
  exp_activation: log_softmax
  AU_activation: none
learning:
  learning_rate: 0.0001
  optimizer: Adam
  batch_size_train: 64
  batch_size_test: 64
  batch_size_val: 64
  train_K: 1
  val_K: 1
  test_K: 1
  train_K_policy: random
  val_K_policy: sequential
  test_K_policy: sequential
  num_gpus: 1
  gpu_memory_min_gb: 30
  early_stopping:
    patience: 10
  checkpoint_after_training: best
  logger_type: WandbLogger
  test_vis_frequency: 100
  max_steps: 100000000
  max_epochs: 50
  val_check_interval: 0.2
  tags:
  - DETAIL_EXCHANGE_SWEEP
  - FINA:_DETAIL_MTURK
  - GT_MASK
  - NEW_SPLIT
inout:
  output_dir: /mnt/500gb/Workspace/Repos/gdl/assets/EmotionRecognition/facerec_based_models
  full_run_dir: /mnt/500gb/Workspace/Repos/gdl/assets/EmotionRecognition/facerec_based_models/EMOCA_detail-emorec
  checkpoint_dir: /mnt/500gb/Workspace/Repos/gdl/assets/EmotionRecognition/facerec_based_models/EMOCA_detail-emorec/checkpoints
  name: EmotionRecognition_Affec_ExpDECA_nl-4BatchNorm1d_id_exp_jaw_shake_samp-balanced_expr_early
  time: 2022_01_29_21-59-07
  random_id: '3822537833951552856'
